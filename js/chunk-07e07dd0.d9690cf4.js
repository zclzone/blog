(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-07e07dd0"],{"05c1":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"btns"},[r("router-link",{staticStyle:{"margin-right":"10px"},attrs:{to:"/admin/list"}},[r("el-button",{attrs:{type:"info",icon:"el-icon-close",plain:""}},[e._v("退出")])],1),"edit"==e.action||"add"==e.action?r("el-button",{attrs:{type:"primary",icon:"el-icon-finished",plain:""},on:{click:e.savePost}},[e._v("保存")]):e._e()],1),r("el-form",{ref:"postForm",attrs:{"label-width":"50px","label-position":"left"}},[r("el-row",{staticClass:"form-row"},[r("el-col",{attrs:{span:5}},[r("el-form-item",{attrs:{label:"标题"}},[r("el-input",{attrs:{placeholder:"文章标题",disabled:"edit"==e.action},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)],1),r("el-col",{attrs:{span:3,offset:1}},[r("el-form-item",{attrs:{label:"分类"}},[r("el-select",{attrs:{placeholder:"文章类型"},model:{value:e.category,callback:function(t){e.category=t},expression:"category"}},e._l(e.categories,(function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),r("el-col",{attrs:{span:9,offset:1}},[r("el-form-item",{attrs:{label:"简介"}},[r("el-input",{attrs:{placeholder:"文章简介"},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}})],1)],1),r("el-col",{attrs:{span:2,offset:1}},[r("el-form-item",{attrs:{label:"发布"}},[r("el-checkbox",{model:{value:e.isPublish,callback:function(t){e.isPublish=t},expression:"isPublish"}})],1)],1),r("el-col",{attrs:{span:2}},[r("el-form-item",{attrs:{label:"推荐"}},[r("el-checkbox",{model:{value:e.isRecommend,callback:function(t){e.isRecommend=t},expression:"isRecommend"}})],1)],1)],1),r("mavon-editor",{ref:"md",model:{value:e.post.content,callback:function(t){e.$set(e.post,"content",t)},expression:"post.content"}})],1)],1)},a=[],s=(r("a4d3"),r("e01a"),r("d81d"),r("b0c0"),r("5530")),o=(r("96cf"),r("1da1")),i=r("714d"),c=r("83d6"),u=c.siteOptions,l={beforeRouteEnter:function(e,t,r){switch(e.params.action){case"add":document.title="".concat(e.meta.title,"-创建");break;case"edit":document.title="".concat(e.meta.title,"-编辑");break;default:document.title="".concat(e.meta.title,"-查看")}r()},data:function(){return{path:this.$route.query.path,action:this.$route.params.action,post:{},postList:{},categories:[],name:this.$route.query.name,category:this.$route.query.category||"",description:this.$route.query.description||"",isRecommend:!!this.$route.query.isRecommend||!1,isPublish:!!this.$route.query.isPublish||!1,author:u.author||""}},mounted:function(){this.getPost(this.path),this.getPostList(),this.getCategory()},methods:{getPost:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:return t.$loading.show(),r.next=5,i["a"].getFile(e);case 5:if(n=r.sent,t.$loading.hide(),n){r.next=10;break}return t.$message.error("No data"),r.abrupt("return");case 10:t.post=n;case 11:case"end":return r.stop()}}),r)})))()},getPostList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$loading.show(),t.next=3,i["a"].getFile("db/_post/postList.json");case 3:if(r=t.sent,e.$loading.hide(),r){t.next=8;break}return e.$message.error("No data"),t.abrupt("return");case 8:e.postList=JSON.parse(r.content),e.postList.name=r.name,e.postList.path=r.path,e.postList.sha=r.sha;case 12:case"end":return t.stop()}}),t)})))()},getCategory:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$loading.show(),t.next=3,i["a"].getFile("db/_post/category.json");case 3:if(r=t.sent,e.$loading.hide(),r){t.next=8;break}return e.$message.error("No data"),t.abrupt("return");case 8:e.categories=JSON.parse(r.content).data;case 9:case"end":return t.stop()}}),t)})))()},savePost:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("edit"!=e.action){t.next=3;break}return e.updatePost(),t.abrupt("return");case 3:return e.$loading.show(),t.next=6,i["a"].addFile("db/_post/list/".concat(e.name,".md"),e.post.content);case 6:if(r=t.sent,"OK"===r.status){t.next=11;break}return e.$loading.hide(),e.$message.error(r.msg),t.abrupt("return");case 11:return e.postList.content.data.unshift({name:e.name,path:"db/_post/list/".concat(e.name,".md"),category:e.category,description:e.description,isRecommend:e.isRecommend,isPublish:e.isPublish,author:e.author,cover:"",date:new Date}),t.next=14,i["a"].updateFile(e.postList.path,e.postList.sha,JSON.stringify(e.postList));case 14:if(n=t.sent,e.$loading.hide(),"OK"===n.status){t.next=19;break}return e.$message.error(n.msg),t.abrupt("return");case 19:e.$message(n.msg),e.$router.push("/admin/list");case 21:case"end":return t.stop()}}),t)})))()},updatePost:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.$loading.show(),t.next=3,i["a"].updateFile("db/_post/list/".concat(e.name,".md"),e.post.sha,e.post.content);case 3:if(r=t.sent,"OK"===r.status){t.next=8;break}return e.$loading.hide(),e.$message.error(r.msg),t.abrupt("return");case 8:return e.postList.content.data=e.postList.content.data.map((function(t){return t.path==e.path?Object(s["a"])(Object(s["a"])({},t),{},{name:e.name,description:e.description,isRecommend:e.isRecommend,isPublish:e.isPublish,category:e.category,cover:""}):t})),t.next=11,i["a"].updateFile(e.postList.path,e.postList.sha,JSON.stringify(e.postList));case 11:if(n=t.sent,e.$loading.hide(),"OK"===n.status){t.next=16;break}return e.$message.error(n.msg),t.abrupt("return");case 16:e.$message(n.msg),e.$router.push("/admin/list");case 18:case"end":return t.stop()}}),t)})))()}}},p=l,d=(r("1893"),r("2877")),m=Object(d["a"])(p,n,a,!1,null,"43a6d932",null);t["default"]=m.exports},1893:function(e,t,r){"use strict";var n=r("5f4c"),a=r.n(n);a.a},5530:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));r("a4d3"),r("4de4"),r("4160"),r("e439"),r("dbb4"),r("b64b"),r("159b");function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},"5f4c":function(e,t,r){},dbb4:function(e,t,r){var n=r("23e7"),a=r("83ab"),s=r("56ef"),o=r("fc6a"),i=r("06cf"),c=r("8418");n({target:"Object",stat:!0,sham:!a},{getOwnPropertyDescriptors:function(e){var t,r,n=o(e),a=i.f,u=s(n),l={},p=0;while(u.length>p)r=a(n,t=u[p++]),void 0!==r&&c(l,t,r);return l}})},e439:function(e,t,r){var n=r("23e7"),a=r("d039"),s=r("fc6a"),o=r("06cf").f,i=r("83ab"),c=a((function(){o(1)})),u=!i||c;n({target:"Object",stat:!0,forced:u,sham:!i},{getOwnPropertyDescriptor:function(e,t){return o(s(e),t)}})}}]);
//# sourceMappingURL=chunk-07e07dd0.d9690cf4.js.map